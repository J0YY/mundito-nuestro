(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1854:function(e,t,s){Promise.resolve().then(s.bind(s,1585))},1585:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var a=s(7437),l=s(2265),i=s(2752),r=s(4887);function n(e){let{onClose:t}=e;return(0,r.createPortal)((0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 animate-fade",children:(0,a.jsxs)("div",{className:"w-full max-w-lg romantic-card p-5 shadow-2xl animate-pop",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"About mundito nuestro"}),(0,a.jsx)("button",{className:"text-slate-500 hover:text-slate-800",onClick:t,children:"Close"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm leading-relaxed",children:[(0,a.jsx)("p",{children:"A shared map to pin the moments of Joy & Socrates across the world — core memories, thoughts, bucket list places, anniversaries, inside jokes, and more."}),(0,a.jsx)("p",{children:"Built with love using Next.js, Tailwind, React Leaflet, Supabase, and Zustand. Data is stored in Supabase with realtime updates."}),(0,a.jsx)("p",{children:"Tip: Click anywhere on the map to add a memory. Use the filters, timeline, and cinematic mode to relive your story."}),(0,a.jsx)("p",{className:"opacity-75",children:"These are your memories — may they keep expanding. \uD83D\uDCAB"})]})]})}),document.body)}function c(){let{viewMode:e,setViewMode:t,showTrails:s,setShowTrails:r,showThoughtHeatmap:c,setShowThoughtHeatmap:o,mapPerspective:d,setMapPerspective:m}=(0,i.q)(),[x,h]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{u?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[u]),(0,a.jsxs)("header",{className:"sticky top-0 z-30 px-4 pt-6 pb-2 animate-rise",children:[(0,a.jsxs)("div",{className:"glass-panel flex flex-wrap items-center gap-4 px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-[200px]",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-core to-pink-400 shadow-lg flex items-center justify-center text-white text-xl font-semibold",children:"mn"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:"mundito nuestro"}),(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Joy & Socrates atlas"})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-wrap items-center justify-end gap-3",children:[(0,a.jsxs)("div",{className:"segmented shadow-none bg-white/70 order-2",children:[(0,a.jsx)("button",{className:"seg ".concat("map"===e?"active":""),onClick:()=>t("map"),children:"Map"}),(0,a.jsx)("button",{className:"seg ".concat("timeline"===e?"active":""),onClick:()=>t("timeline"),children:"Timeline"}),(0,a.jsx)("button",{className:"seg ".concat("cinematic"===e?"active":""),onClick:()=>t("cinematic"),children:"Cinematic"})]}),"map"===e?(0,a.jsxs)("div",{className:"segmented shadow-none bg-white/70 order-3",children:[(0,a.jsx)("button",{className:"seg ".concat("map"===d?"active":""),onClick:()=>m("map"),children:"Surface"}),(0,a.jsx)("button",{className:"seg ".concat("globe"===d?"active":""),onClick:()=>m("globe"),children:"Globe"})]}):null,(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-2 order-3",children:[(0,a.jsxs)("label",{className:"glass-panel px-3 py-1 rounded-full text-xs flex items-center gap-2 bg-white/70",children:[(0,a.jsx)("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked)}),"Trails"]}),(0,a.jsxs)("label",{className:"glass-panel px-3 py-1 rounded-full text-xs flex items-center gap-2 bg-white/70",children:[(0,a.jsx)("input",{type:"checkbox",checked:c,onChange:e=>o(e.target.checked)}),"Heatmap"]})]}),(0,a.jsx)("button",{className:"btn-soft order-4",onClick:()=>h(!0),children:"About"}),(0,a.jsx)("button",{className:"btn-soft order-5",onClick:()=>p(e=>!e),children:u?"Light":"Dark"})]})]}),x?(0,a.jsx)(n,{onClose:()=>h(!1)}):null]})}function o(e){let{children:t}=e;return(0,a.jsx)("div",{className:"dashboard-shell",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:t})})}var d=s(7818),m=s(6792);let x=["core","thought","bucket_list","trip","milestone","inside_joke","celebration","heartbreak_repair","anniversary","secret"];function h(){let{filters:e,setFilters:t,resetFilters:s,getAllYears:l}=(0,i.q)(),r=l();return(0,a.jsxs)("div",{className:"space-y-4 animate-rise",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Contributor"}),(0,a.jsx)("div",{className:"segmented",children:["all","joy","socrates"].map(s=>(0,a.jsx)("button",{className:"seg ".concat(e.contributor===s?"active":""," hover-elevate"),onClick:()=>t({contributor:s}),children:"all"===s?"All":"joy"===s?"Joy":"Socrates"},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Categories"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:x.map(s=>{let l=e.categories.has(s);return(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:l,onChange:a=>{let l=new Set(e.categories);a.target.checked?l.add(s):l.delete(s),t({categories:l})}}),(0,a.jsx)("span",{className:"romantic-tag",children:m.Hs[s]})]},s)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.hideSecret,onChange:e=>t({hideSecret:e.target.checked})}),"Hide secret pins"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm mb-1",children:"Year"}),(0,a.jsxs)("select",{value:e.year,onChange:e=>t({year:"all"===e.target.value?"all":Number(e.target.value)}),className:"select",children:[(0,a.jsx)("option",{value:"all",children:"All years"}),r.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{className:"btn-soft",onClick:s,children:"Clear filters"})})]})}function u(){let{getFilteredMemories:e,setSelectedMemoryId:t,setViewMode:s}=(0,i.q)(),l=e().slice().sort((e,t)=>{var s,a;return new Date("".concat(e.date," ").concat(null!==(s=e.time)&&void 0!==s?s:"00:00:00")).getTime()-new Date("".concat(t.date," ").concat(null!==(a=t.time)&&void 0!==a?a:"00:00:00")).getTime()});return l.length?(0,a.jsx)("div",{className:"max-h-[60vh] overflow-auto divide-y divide-white/10 animate-rise",children:l.map(e=>(0,a.jsxs)("button",{className:"w-full text-left p-3 hover:bg-white/60 dark:hover:bg-white/10 transition hover-elevate",onClick:()=>{t(e.id),s("map")},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-semibold ".concat("joy"===e.contributor?"bg-rose-200 text-rose-700":"bg-sky-200 text-sky-700"),children:"joy"===e.contributor?"J":"S"}),(0,a.jsx)("div",{className:"font-medium",children:e.title})]}),(0,a.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full",style:{background:"".concat(m.pG[e.category],"30"),color:"#111"},children:[m.Hs[e.category],"bucket_list"===e.category&&e.is_bucket_list_completed?" \xb7 Completed":""]})]}),(0,a.jsxs)("div",{className:"text-xs text-slate-500",children:[e.date,e.time?" \xb7 ".concat(e.time.slice(0,5)):""]}),(0,a.jsxs)("div",{className:"text-sm line-clamp-2 mt-1",children:[e.description.slice(0,100),e.description.length>100?"…":""]}),e.photo_url?(0,a.jsx)("img",{src:e.photo_url,alt:"",className:"mt-2 h-24 w-full object-cover rounded-lg"}):null]},e.id))}):(0,a.jsx)("div",{className:"p-6 text-center text-slate-500",children:"No moments here yet."})}function p(){var e,t;let{memories:s,timeRange:r,setTimeRange:n}=(0,i.q)(),{minDate:c,maxDate:o}=(0,l.useMemo)(()=>{if(!s.length)return{minDate:"",maxDate:""};let e=s.map(e=>e.date).sort();return{minDate:e[0],maxDate:e[e.length-1]}},[s]);return(0,a.jsxs)("div",{className:"space-y-2 animate-rise",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Time range"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Start"}),(0,a.jsx)("input",{type:"date",className:"input",min:c,max:o,value:null!==(e=r.start)&&void 0!==e?e:"",onChange:e=>n({start:e.target.value||null})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"End"}),(0,a.jsx)("input",{type:"date",className:"input",min:c,max:o,value:null!==(t=r.end)&&void 0!==t?t:"",onChange:e=>n({end:e.target.value||null})})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{className:"btn-soft",onClick:()=>n({start:null,end:null}),children:"Clear"})})]})}let g=(e,t)=>({x:(t+180)/360*520,y:(90-e)/180*520}),f=e=>{let{memories:t,activeIndex:s}=e,i=(0,l.useMemo)(()=>t.map(e=>g(e.lat,e.lng)),[t]),r=i.map(e=>"".concat(e.x,",").concat(e.y)).join(" "),n=i.slice(0,s+1).map(e=>"".concat(e.x,",").concat(e.y)).join(" "),c=i[s];return(0,a.jsxs)("svg",{width:520,height:520,viewBox:"0 0 ".concat(520," ").concat(520),className:"w-full h-full",children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"trailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:"#a5b4fc"}),(0,a.jsx)("stop",{offset:"50%",stopColor:"#ff80b5"}),(0,a.jsx)("stop",{offset:"100%",stopColor:"#7cd4ff"})]}),(0,a.jsxs)("radialGradient",{id:"glowField",cx:"50%",cy:"50%",r:"70%",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:"rgba(255,255,255,0.15)"}),(0,a.jsx)("stop",{offset:"100%",stopColor:"rgba(255,255,255,0)"})]}),(0,a.jsxs)("filter",{id:"glowBlur",x:"-40%",y:"-40%",width:"180%",height:"180%",children:[(0,a.jsx)("feGaussianBlur",{stdDeviation:"12",result:"coloredBlur"}),(0,a.jsxs)("feMerge",{children:[(0,a.jsx)("feMergeNode",{in:"coloredBlur"}),(0,a.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),(0,a.jsx)("rect",{width:"100%",height:"100%",fill:"url(#glowField)"}),(0,a.jsx)("polyline",{points:r,stroke:"rgba(255,255,255,0.18)",strokeWidth:4,fill:"none",strokeLinecap:"round"}),(0,a.jsx)("polyline",{points:n,stroke:"url(#trailGradient)",strokeWidth:6,fill:"none",strokeLinecap:"round",filter:"url(#glowBlur)"}),(0,a.jsx)("circle",{cx:c.x,cy:c.y,r:10,fill:"#fff",filter:"url(#glowBlur)"})]})};function j(){let{memories:e,setViewMode:t}=(0,i.q)(),s=(0,l.useMemo)(()=>e.filter(e=>"core"===e.category).sort((e,t)=>{var s,a;return new Date("".concat(e.date," ").concat(null!==(s=e.time)&&void 0!==s?s:"00:00:00")).getTime()-new Date("".concat(t.date," ").concat(null!==(a=t.time)&&void 0!==a?a:"00:00:00")).getTime()}),[e]),[r,n]=(0,l.useState)(0),[c,o]=(0,l.useState)(!0),d=(0,l.useRef)(null);if((0,l.useEffect)(()=>{if(0!==s.length&&c)return d.current=setTimeout(()=>n(e=>(e+1)%s.length),5e3),()=>{d.current&&clearTimeout(d.current)}},[r,s.length,c]),!s.length)return(0,a.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70",children:(0,a.jsxs)("div",{className:"romantic-card p-6 text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"No core memories yet"}),(0,a.jsx)("button",{className:"px-3 py-2 rounded-lg bg-white/60 dark:bg-white/10 border border-white/20",onClick:()=>t("map"),children:"Exit"})]})});let m=s[r];return(0,a.jsxs)("div",{className:"fixed inset-0 z-[100] bg-gradient-to-br from-[#05060b] via-[#0f1326] to-[#231041] text-white overflow-auto pointer-events-auto",children:[(0,a.jsx)("div",{className:"sticky top-3 flex justify-end px-4",children:(0,a.jsx)("button",{className:"px-4 py-2 rounded-full bg-white/15 hover:bg-white/25 backdrop-blur border border-white/20",onClick:()=>t("map"),children:"Exit Cinematic"})}),(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"max-w-6xl w-full grid lg:grid-cols-[540px,1fr] gap-6 items-center",children:[(0,a.jsxs)("div",{className:"rounded-3xl bg-gradient-to-b from-[#101732] to-[#0b1021] border border-white/10 p-6 animate-rise shadow-[0_25px_60px_-30px_rgba(0,0,0,0.8)]",children:[(0,a.jsx)("div",{className:"text-xs uppercase tracking-[0.4em] text-slate-300 mb-3",children:"Chronicle trail"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f,{memories:s,activeIndex:r}),(0,a.jsxs)("div",{className:"absolute bottom-4 left-4 text-sm text-slate-300",children:["Glowing path of ",s.length," core moments."]})]})]}),(0,a.jsxs)("div",{className:"rounded-3xl bg-gradient-to-b from-[#121936] to-[#0a0f1c] border border-white/10 p-6 animate-rise shadow-[0_25px_60px_-30px_rgba(0,0,0,0.8)]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-300",children:["Memory #",r+1,"/",s.length]}),(0,a.jsx)("h2",{className:"text-3xl font-semibold",children:m.title}),(0,a.jsxs)("p",{className:"text-sm text-slate-300",children:[m.date,m.time?" \xb7 ".concat(m.time.slice(0,5)):""," \xb7 ","joy"===m.contributor?"Joy":"Socrates"]})]}),(0,a.jsx)("button",{className:"btn-soft",onClick:()=>o(e=>!e),children:c?"Pause":"Play"})]}),m.photo_url?(0,a.jsx)("img",{src:m.photo_url,alt:"",className:"rounded-2xl mb-4 max-h-72 w-full object-cover shadow-[0_15px_45px_-25px_rgba(255,255,255,0.5)]"}):null,(0,a.jsx)("p",{className:"text-lg leading-relaxed whitespace-pre-wrap mb-4",children:m.description}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"px-4 py-2 rounded-full bg-white/15 hover:bg-white/25 border border-white/20",onClick:()=>n(e=>(e-1+s.length)%s.length),children:"Previous"}),(0,a.jsx)("button",{className:"px-4 py-2 rounded-full bg-white/15 hover:bg-white/25 border border-white/20",onClick:()=>n(e=>(e+1)%s.length),children:"Next"})]}),(0,a.jsxs)("div",{className:"mt-5",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400 mb-2",children:"Timeline"}),(0,a.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:s.map((e,t)=>(0,a.jsx)("button",{className:"px-3 py-2 rounded-2xl text-sm transition ".concat(t===r?"bg-white text-slate-900":"bg-white/10 text-white/80 hover:bg-white/20"),onClick:()=>n(t),children:e.date},e.id))})]})]})]})})]})}function b(){let e=(0,d.default)(()=>Promise.all([s.e(212),s.e(18)]).then(s.bind(s,7018)),{loadableGenerated:{webpack:()=>[7018]},ssr:!1}),t=(0,d.default)(()=>Promise.all([s.e(603),s.e(689),s.e(271),s.e(416)]).then(s.bind(s,7416)),{loadableGenerated:{webpack:()=>[7416]},ssr:!1}),{viewMode:r,fetchMemories:n,subscribeToRealtime:m,memories:x,mapPerspective:g}=(0,i.q)();(0,l.useEffect)(()=>{n(),m()},[n,m]);let f=x.filter(e=>"core"===e.category).length,b=x.filter(e=>"bucket_list"===e.category),v=b.filter(e=>e.is_bucket_list_completed).length,N=x[x.length-1];return(0,a.jsxs)(o,{children:[(0,a.jsx)(c,{}),(0,a.jsxs)("div",{className:"px-4 pb-8 space-y-5",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{className:"stat-card animate-rise",children:[(0,a.jsx)("span",{className:"stat-label",children:"Memories logged"}),(0,a.jsx)("span",{className:"stat-value",children:x.length||"—"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 dark:text-slate-300",children:["Across ",new Set(x.map(e=>e.category)).size||0," categories"]})]}),(0,a.jsxs)("div",{className:"stat-card animate-rise",children:[(0,a.jsx)("span",{className:"stat-label",children:"Core memories"}),(0,a.jsx)("span",{className:"stat-value",children:f||"—"}),(0,a.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-300",children:"These anchor moments guide the cinematic mode."})]}),(0,a.jsxs)("div",{className:"stat-card animate-rise",children:[(0,a.jsx)("span",{className:"stat-label",children:"Bucket list"}),(0,a.jsxs)("span",{className:"stat-value",children:[v,"/",b.length||"—"]}),(0,a.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-300",children:"Completed together so far."})]})]}),N?(0,a.jsxs)("div",{className:"glass-panel p-5 flex items-center justify-between gap-4 animate-rise",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.25em] text-slate-400",children:"Latest drop"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:N.title}),(0,a.jsxs)("p",{className:"text-sm text-slate-500",children:[N.date," \xb7 ",N.category.replace("_"," ")]})]}),(0,a.jsx)("button",{className:"btn-brand",onClick:()=>{var e;return null===(e=window)||void 0===e?void 0:e.scrollTo({top:0,behavior:"smooth"})},children:"Relive"})]}):null,(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(0,3fr)_360px] gap-4 mt-6 lg:min-h-[720px] items-stretch",children:[(0,a.jsx)("div",{className:"glass-panel p-0 overflow-hidden lg:h-full",children:"globe"===g?(0,a.jsx)(t,{}):(0,a.jsx)(e,{})}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 lg:h-full",children:[(0,a.jsx)("div",{className:"glass-panel p-4 hover-elevate flex-1 overflow-auto",children:(0,a.jsx)(h,{})}),(0,a.jsx)("div",{className:"glass-panel p-4 hover-elevate",children:(0,a.jsx)(p,{})}),(0,a.jsx)("div",{className:"glass-panel p-0 overflow-hidden hover-elevate flex-[1.1]",children:(0,a.jsx)(u,{})})]})]}),"cinematic"===r?(0,a.jsx)(j,{}):null]})]})}},1180:function(e,t,s){"use strict";s.d(t,{O:function(){return a}});let a=(0,s(3234).eI)("https://rndyshkluyvharcrcjap.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJuZHlzaGtsdXl2aGFyY3JjamFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MDM2NDMsImV4cCI6MjA3ODk3OTY0M30.BSP_bdAfRIcfPR9NrNIfpUM4yjHzUVYBR6o9szif51o")},2752:function(e,t,s){"use strict";s.d(t,{q:function(){return d}});var a=s(9099),l=s(9291),i=s(1180),r=s(6792),n=s(5062),c=s(8859),o=s(6717);let d=(0,a.Ue)()((0,l.mW)((e,t)=>({memories:[],loading:!1,error:null,viewMode:"map",mapPerspective:"map",pendingFlyTo:null,initialCenter:{lat:20,lng:0},initialZoom:2,mapVersion:0,filters:{contributor:"all",categories:new Set(["core","thought","bucket_list","trip","milestone","inside_joke","celebration","heartbreak_repair","anniversary","secret"]),year:"all",hideSecret:!1},timeRange:{start:null,end:null},showTrails:!1,showThoughtHeatmap:!1,selectedMemoryId:null,fetchMemories:async()=>{e({loading:!0,error:null});let{data:t,error:s}=await i.O.from("memories").select("*").order("date",{ascending:!0}).order("time",{ascending:!0,nullsFirst:!0});if(s){e({error:s.message,loading:!1});return}e({memories:(t||[]).map(e=>(e.color||(e.color=r.pG[e.category]||null),e)),loading:!1})},subscribeToRealtime:()=>{i.O.channel("memories-changes").on("postgres_changes",{event:"*",schema:"public",table:"memories"},t=>{let{eventType:s,new:a,old:l}=t;e(e=>{if("INSERT"===s){let t=[...e.memories,a];return t.sort((e,t)=>{var s,a;return new Date("".concat(e.date," ").concat(null!==(s=e.time)&&void 0!==s?s:"00:00:00")).getTime()-new Date("".concat(t.date," ").concat(null!==(a=t.time)&&void 0!==a?a:"00:00:00")).getTime()}),{memories:t}}return"UPDATE"===s?{memories:e.memories.map(e=>e.id===a.id?a:e)}:"DELETE"===s?{memories:e.memories.filter(e=>e.id!==l.id)}:e})}).subscribe()},addMemory:async t=>{let s={...t};s.color||(s.color=r.pG[s.category]);let{data:a,error:l}=await i.O.from("memories").insert(s).select().single();return l?(e({error:l.message}),null):(e(e=>({memories:[...e.memories,a]})),a)},updateMemory:async(t,s)=>{let{error:a}=await i.O.from("memories").update(s).eq("id",t);a&&e({error:a.message})},deleteMemory:async t=>{let{error:s}=await i.O.from("memories").delete().eq("id",t);s&&e({error:s.message})},setViewMode:t=>e({viewMode:t}),setMapPerspective:t=>e({mapPerspective:t}),setFilters:t=>e(e=>({filters:{...e.filters,...t}})),resetFilters:()=>e({filters:{contributor:"all",categories:new Set(["core","thought","bucket_list","trip","milestone","inside_joke","celebration","heartbreak_repair","anniversary","secret"]),year:"all",hideSecret:!1}}),setTimeRange:t=>e(e=>({timeRange:{...e.timeRange,...t}})),setShowTrails:t=>e({showTrails:t}),setShowThoughtHeatmap:t=>e({showThoughtHeatmap:t}),setSelectedMemoryId:t=>e({selectedMemoryId:t}),flyTo:(t,s,a)=>{console.log("[Store] set pendingFlyTo",{lat:t,lng:s,zoom:a}),e(e=>({pendingFlyTo:{lat:t,lng:s,zoom:a},initialCenter:{lat:t,lng:s},initialZoom:null!=a?a:e.initialZoom,mapVersion:e.mapVersion+1}))},getFilteredMemories:()=>{let{memories:e,filters:s,timeRange:a}=t();return e.filter(e=>!(s.hideSecret&&"secret"===e.category||"all"!==s.contributor&&e.contributor!==s.contributor||!s.categories.has(e.category)||"all"!==s.year&&new Date(e.date).getFullYear()!==s.year||a.start&&(0,n.R)((0,c.D)(e.date),(0,c.D)(a.start))||a.end&&(0,o.A)((0,c.D)(e.date),(0,c.D)(a.end))))},getAllYears:()=>{let e=new Set;for(let s of t().memories){let t=new Date(s.date).getFullYear();e.add(t)}return Array.from(e).sort()}})))},6792:function(e,t,s){"use strict";s.d(t,{Hs:function(){return l},pG:function(){return a}});let a={core:"#ff80b5",thought:"#7cd4ff",bucket_list:"#ffd700",trip:"#9aff95",milestone:"#ffae42",inside_joke:"#c084fc",celebration:"#ffdd95",heartbreak_repair:"#fb7185",anniversary:"#f97316",secret:"#9ca3af"},l={core:"Core",thought:"Thought",bucket_list:"Bucket List",trip:"Trip",milestone:"Milestone",inside_joke:"Inside Joke",celebration:"Celebration",heartbreak_repair:"Heartbreak Repair",anniversary:"Anniversary",secret:"Secret"}}},function(e){e.O(0,[485,971,23,744],function(){return e(e.s=1854)}),_N_E=e.O()}]);